import{A as e,C as t,N as n,O as r,_ as i,c as a,d as o,f as s,g as c,h as l,i as u,j as d,m as f,p,s as m,u as h,v as g,w as _,x as v}from"./index-D-ACJEW6.js";var y={name:`SystemUsers`,setup(){let t=e([]),n=e(``),r=e(``),i=e(``),a=e([]),o=e(!1),s=e(1),c=e(!1),l=e(!1),d=e({username:``,password:``,role:`student`,status:`active`,studentNo:``,department:``}),p=()=>{u.adminData&&u.adminData.users?t.value=u.adminData.users.map(e=>({...e,createdAt:e.createdAt||new Date().toISOString(),lastLogin:e.lastLogin||null})):t.value=[{id:`SA999`,username:`superadmin`,role:`superAdmin`,status:`active`,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()},{id:`A001`,username:`admin1`,role:`admin`,status:`active`,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()},{id:`T001`,username:`teacher1`,role:`teacher`,status:`active`,department:`计算机科学与技术`,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()},{id:`T002`,username:`teacher2`,role:`teacher`,status:`active`,department:`数学`,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()},{id:`T003`,username:`teacher3`,role:`teacher`,status:`inactive`,department:`物理`,createdAt:new Date().toISOString(),lastLogin:null},{id:`S001`,username:`student1`,role:`student`,status:`active`,studentNo:`2022001`,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()},{id:`S002`,username:`student2`,role:`student`,status:`active`,studentNo:`2022002`,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()},{id:`S003`,username:`student3`,role:`student`,status:`active`,studentNo:`2022003`,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()},{id:`S004`,username:`student4`,role:`student`,status:`inactive`,studentNo:`2022004`,createdAt:new Date().toISOString(),lastLogin:null},{id:`S005`,username:`student5`,role:`student`,status:`active`,studentNo:`2022005`,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()},{id:`S006`,username:`student6`,role:`student`,status:`active`,studentNo:`2022006`,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()},{id:`S007`,username:`student7`,role:`student`,status:`active`,studentNo:`2022007`,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()}]},m=f(()=>{let e=t.value.filter(e=>{let t=!n.value||e.username.toLowerCase().includes(n.value.toLowerCase())||e.id.toLowerCase().includes(n.value.toLowerCase()),a=!r.value||e.role===r.value,o=!i.value||e.status===i.value;return t&&a&&o}),a=(s.value-1)*10;return e.slice(a,a+10)}),h=f(()=>{let e=t.value.filter(e=>{let t=!n.value||e.username.toLowerCase().includes(n.value.toLowerCase())||e.id.toLowerCase().includes(n.value.toLowerCase()),a=!r.value||e.role===r.value,o=!i.value||e.status===i.value;return t&&a&&o});return Math.ceil(e.length/10)}),g=e=>({student:`学生`,teacher:`教师`,admin:`管理员`,superAdmin:`超级管理员`})[e]||e,_=e=>e?new Date(e).toLocaleString(`zh-CN`):`从未登录`,y=()=>{o.value?a.value=m.value.map(e=>e.id):a.value=[]},b=()=>{n.value=``,r.value=``,i.value=``,s.value=1},x=e=>{d.value={id:e.id,username:e.username,password:``,role:e.role,status:e.status,studentNo:e.details?.studentNo||``,department:e.details?.department||``},l.value=!0},S=()=>{c.value=!1,l.value=!1,d.value={username:``,password:``,role:`student`,status:`active`,studentNo:``,department:``}};return v(()=>{p(),u.role!==`superAdmin`&&alert(`权限不足，请联系超级管理员`)}),{users:t,searchQuery:n,roleFilter:r,statusFilter:i,selectedUsers:a,selectAllUsers:o,currentPage:s,totalPages:h,showAddUserDialog:c,showEditUserDialog:l,userForm:d,filteredUsers:m,getRoleText:g,formatDate:_,selectAll:y,resetFilters:b,editUser:x,closeUserDialog:S,saveUser:()=>{if(l.value){let e=t.value.findIndex(e=>e.id===d.value.id);e!==-1&&(t.value[e]={...t.value[e],username:d.value.username,role:d.value.role,status:d.value.status,details:{...t.value[e].details,studentNo:d.value.studentNo,department:d.value.department}},d.value.password&&console.log(`更新用户密码`),alert(`用户更新成功`))}else{let e={id:d.value.role===`student`?`S`+Math.floor(Math.random()*1e3):d.value.role===`teacher`?`T`+Math.floor(Math.random()*100):d.value.role===`admin`?`A`+Math.floor(Math.random()*100):`SA`+Math.floor(Math.random()*100),username:d.value.username,role:d.value.role,status:d.value.status,createdAt:new Date().toISOString(),lastLogin:null,details:{studentNo:d.value.studentNo,department:d.value.department}};t.value.unshift(e),alert(`用户添加成功`)}S()},toggleUserStatus:e=>{let t=e.status===`active`?`inactive`:`active`;confirm(`确定要${t===`active`?`启用`:`禁用`}用户 ${e.username} 吗？`)&&(e.status=t,alert(`用户已${t===`active`?`启用`:`禁用`}`))},deleteUser:e=>{confirm(`确定要删除用户 ${e.username} 吗？此操作不可恢复！`)&&(t.value=t.value.filter(t=>t.id!==e.id),alert(`用户删除成功`))},exportUsers:()=>{alert(`用户数据导出成功`)},importUsers:()=>{alert(`请选择用户数据文件进行导入`)}}}},b={class:`system-users`},x={class:`page-header`},S={class:`header-actions`},C={class:`search-filter`},w={class:`users-table-container`},T={class:`users-table`},E=[`value`],D=[`onClick`],O=[`onClick`],k=[`onClick`],A={key:0,class:`empty-state`},j={class:`pagination`},M=[`disabled`],N=[`disabled`],P={class:`page-info`},F=[`disabled`],I=[`disabled`],L={class:`dialog-header`},R={class:`dialog-body`},z={class:`form-group`},B={class:`form-group`},V=[`required`],H={class:`form-group`},U={class:`form-group`},W={key:0,class:`form-group`},G={key:1,class:`form-group`},K={class:`dialog-footer`};function q(e,u,f,m,v,y){return t(),i(`div`,b,[l(`div`,x,[u[26]||=l(`h2`,null,`用户管理`,-1),l(`div`,S,[l(`button`,{class:`action-button primary`,onClick:u[0]||=e=>m.showAddUserDialog=!0},`添加用户`),l(`button`,{class:`action-button`,onClick:u[1]||=(...e)=>m.exportUsers&&m.exportUsers(...e)},`导出用户`),l(`button`,{class:`action-button`,onClick:u[2]||=(...e)=>m.importUsers&&m.importUsers(...e)},`导入用户`)])]),l(`div`,C,[r(l(`input`,{type:`text`,placeholder:`搜索用户名/ID`,"onUpdate:modelValue":u[3]||=e=>m.searchQuery=e,class:`search-input`},null,512),[[o,m.searchQuery]]),r(l(`select`,{"onUpdate:modelValue":u[4]||=e=>m.roleFilter=e,class:`filter-select`},[...u[27]||=[g(`<option value="" data-v-63870d07>全部角色</option><option value="student" data-v-63870d07>学生</option><option value="teacher" data-v-63870d07>教师</option><option value="admin" data-v-63870d07>管理员</option><option value="superAdmin" data-v-63870d07>超级管理员</option>`,5)]],512),[[h,m.roleFilter]]),r(l(`select`,{"onUpdate:modelValue":u[5]||=e=>m.statusFilter=e,class:`filter-select`},[...u[28]||=[l(`option`,{value:``},`全部状态`,-1),l(`option`,{value:`active`},`启用`,-1),l(`option`,{value:`inactive`},`禁用`,-1)]],512),[[h,m.statusFilter]]),l(`button`,{class:`action-button`,onClick:u[6]||=(...e)=>m.resetFilters&&m.resetFilters(...e)},`重置筛选`)]),l(`div`,w,[l(`table`,T,[l(`thead`,null,[l(`tr`,null,[l(`th`,null,[r(l(`input`,{type:`checkbox`,"onUpdate:modelValue":u[7]||=e=>m.selectAllUsers=e,onChange:u[8]||=(...e)=>m.selectAll&&m.selectAll(...e)},null,544),[[a,m.selectAllUsers]])]),u[29]||=l(`th`,null,`ID`,-1),u[30]||=l(`th`,null,`用户名`,-1),u[31]||=l(`th`,null,`角色`,-1),u[32]||=l(`th`,null,`状态`,-1),u[33]||=l(`th`,null,`创建时间`,-1),u[34]||=l(`th`,null,`最后登录`,-1),u[35]||=l(`th`,null,`操作`,-1)])]),l(`tbody`,null,[(t(!0),i(p,null,_(m.filteredUsers,e=>(t(),i(`tr`,{key:e.id},[l(`td`,null,[r(l(`input`,{type:`checkbox`,"onUpdate:modelValue":u[9]||=e=>m.selectedUsers=e,value:e.id},null,8,E),[[a,m.selectedUsers]])]),l(`td`,null,n(e.id),1),l(`td`,null,n(e.username),1),l(`td`,null,n(m.getRoleText(e.role)),1),l(`td`,null,[l(`span`,{class:d([`status-badge`,e.status])},n(e.status===`active`?`启用`:`禁用`),3)]),l(`td`,null,n(m.formatDate(e.createdAt)),1),l(`td`,null,n(m.formatDate(e.lastLogin)),1),l(`td`,null,[l(`button`,{class:`mini-button`,onClick:t=>m.editUser(e)},`编辑`,8,D),l(`button`,{class:`mini-button`,onClick:t=>m.toggleUserStatus(e)},n(e.status===`active`?`禁用`:`启用`),9,O),e.role===`superAdmin`?c(``,!0):(t(),i(`button`,{key:0,class:`mini-button delete`,onClick:t=>m.deleteUser(e)},` 删除 `,8,k))])]))),128))])]),m.filteredUsers.length===0?(t(),i(`div`,A,[...u[36]||=[l(`p`,null,`没有找到符合条件的用户`,-1)]])):c(``,!0)]),l(`div`,j,[l(`button`,{class:`page-button`,onClick:u[10]||=e=>m.currentPage=1,disabled:m.currentPage===1},`首页`,8,M),l(`button`,{class:`page-button`,onClick:u[11]||=e=>m.currentPage--,disabled:m.currentPage===1},`上一页`,8,N),l(`span`,P,n(m.currentPage)+` / `+n(m.totalPages),1),l(`button`,{class:`page-button`,onClick:u[12]||=e=>m.currentPage++,disabled:m.currentPage===m.totalPages},`下一页`,8,F),l(`button`,{class:`page-button`,onClick:u[13]||=e=>m.currentPage=m.totalPages,disabled:m.currentPage===m.totalPages},`末页`,8,I)]),m.showAddUserDialog||m.showEditUserDialog?(t(),i(`div`,{key:0,class:`dialog-overlay`,onClick:u[25]||=(...e)=>m.closeUserDialog&&m.closeUserDialog(...e)},[l(`div`,{class:`dialog-content`,onClick:u[24]||=s(()=>{},[`stop`])},[l(`div`,L,[l(`h3`,null,n(m.showEditUserDialog?`编辑用户`:`添加用户`),1),l(`button`,{class:`close-button`,onClick:u[14]||=(...e)=>m.closeUserDialog&&m.closeUserDialog(...e)},`×`)]),l(`div`,R,[l(`form`,{onSubmit:u[21]||=s((...e)=>m.saveUser&&m.saveUser(...e),[`prevent`])},[l(`div`,z,[u[37]||=l(`label`,null,`用户名`,-1),r(l(`input`,{type:`text`,"onUpdate:modelValue":u[15]||=e=>m.userForm.username=e,required:``,class:`form-input`},null,512),[[o,m.userForm.username]])]),l(`div`,B,[u[38]||=l(`label`,null,`密码`,-1),r(l(`input`,{type:`password`,"onUpdate:modelValue":u[16]||=e=>m.userForm.password=e,required:!m.showEditUserDialog,class:`form-input`},null,8,V),[[o,m.userForm.password]])]),l(`div`,H,[u[40]||=l(`label`,null,`角色`,-1),r(l(`select`,{"onUpdate:modelValue":u[17]||=e=>m.userForm.role=e,required:``,class:`form-input`},[...u[39]||=[l(`option`,{value:`student`},`学生`,-1),l(`option`,{value:`teacher`},`教师`,-1),l(`option`,{value:`admin`},`管理员`,-1),l(`option`,{value:`superAdmin`},`超级管理员`,-1)]],512),[[h,m.userForm.role]])]),l(`div`,U,[u[42]||=l(`label`,null,`状态`,-1),r(l(`select`,{"onUpdate:modelValue":u[18]||=e=>m.userForm.status=e,required:``,class:`form-input`},[...u[41]||=[l(`option`,{value:`active`},`启用`,-1),l(`option`,{value:`inactive`},`禁用`,-1)]],512),[[h,m.userForm.status]])]),m.userForm.role===`student`?(t(),i(`div`,W,[u[43]||=l(`label`,null,`学号`,-1),r(l(`input`,{type:`text`,"onUpdate:modelValue":u[19]||=e=>m.userForm.studentNo=e,class:`form-input`},null,512),[[o,m.userForm.studentNo]])])):c(``,!0),m.userForm.role===`teacher`?(t(),i(`div`,G,[u[44]||=l(`label`,null,`部门`,-1),r(l(`input`,{type:`text`,"onUpdate:modelValue":u[20]||=e=>m.userForm.department=e,class:`form-input`},null,512),[[o,m.userForm.department]])])):c(``,!0)],32)]),l(`div`,K,[l(`button`,{class:`action-button`,onClick:u[22]||=(...e)=>m.closeUserDialog&&m.closeUserDialog(...e)},`取消`),l(`button`,{class:`action-button primary`,onClick:u[23]||=(...e)=>m.saveUser&&m.saveUser(...e)},`保存`)])])])):c(``,!0)])}var J=m(y,[[`render`,q],[`__scopeId`,`data-v-63870d07`]]);export{J as default};