import{A as e,C as t,M as n,N as r,O as i,_ as a,d as o,f as s,g as c,h as l,j as u,m as d,o as f,p,s as m,u as h,v as g,w as _,x as ee}from"./index-D-ACJEW6.js";var v={name:`TeacherCourseSchedule`,setup(){let t=f(),n=e(1),r=e(``),i=e(!1),a=e(null),o=reactive({courseName:``,classroom:``,studentCount:0,weekDay:0,timeSlot:0,duration:1}),s=[`#e3f2fd`,`#e8f5e9`,`#fff3e0`,`#f3e5f5`,`#e0f7fa`,`#fff8e1`,`#f1f8e9`,`#fafafa`,`#e1f5fe`,`#fce4ec`],c=e([{id:101,courseName:`数据结构`,classroom:`A101`,studentCount:35,weekDay:0,timeSlot:0,duration:2,color:`#e3f2fd`},{id:102,courseName:`算法分析`,classroom:`B202`,studentCount:28,weekDay:0,timeSlot:3,duration:2,color:`#e8f5e9`},{id:103,courseName:`数据库原理`,classroom:`C303`,studentCount:42,weekDay:1,timeSlot:1,duration:2,color:`#fff3e0`},{id:104,courseName:`操作系统`,classroom:`D404`,studentCount:38,weekDay:2,timeSlot:0,duration:2,color:`#f3e5f5`},{id:105,courseName:`计算机网络`,classroom:`A102`,studentCount:45,weekDay:2,timeSlot:4,duration:1,color:`#e0f7fa`},{id:106,courseName:`人工智能`,classroom:`E505`,studentCount:30,weekDay:3,timeSlot:2,duration:2,color:`#fff8e1`},{id:107,courseName:`机器学习`,classroom:`B203`,studentCount:25,weekDay:4,timeSlot:1,duration:2,color:`#f1f8e9`},{id:108,courseName:`软件工程`,classroom:`C304`,studentCount:32,weekDay:4,timeSlot:4,duration:1,color:`#fafafa`}]),l=[{time:`08:30-10:00`,index:0},{time:`10:20-11:50`,index:1},{time:`14:00-15:30`,index:2},{time:`15:50-17:20`,index:3},{time:`19:00-20:30`,index:4}],u=d(()=>{let e=new Date,t=e.getDay()||7,n=new Date(e);return n.setDate(e.getDate()-t+1),[{name:`周一`,date:g(n)},{name:`周二`,date:g(new Date(n.getTime()+864e5))},{name:`周三`,date:g(new Date(n.getTime()+864e5*2))},{name:`周四`,date:g(new Date(n.getTime()+864e5*3))},{name:`周五`,date:g(new Date(n.getTime()+864e5*4))}]}),p=(e,t)=>c.value.filter(n=>n.weekDay===e&&n.timeSlot===t),m=d(()=>{let e=(new Date().getDay()||1)-1;return e<0||e>4?[]:c.value.filter(t=>t.weekDay===e).map(e=>({...e,time:l[e.timeSlot].time})).sort((e,t)=>e.timeSlot-t.timeSlot)}),h=d(()=>[{id:201,courseName:`高级编程技术`,classroom:`F606`,date:`明天 周三`,time:`14:00-15:30`},{id:202,courseName:`云计算基础`,classroom:`G707`,date:`后天 周四`,time:`10:20-11:50`}]),g=e=>{let t=e.getMonth()+1,n=e.getDate();return`${t}/${n}`},_=()=>{let e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();return`${t}年${n}月${r}日`},v=e=>{let[t]=e.split(`-`),[n,r]=t.split(`:`).map(Number),i=new Date,a=i.getHours(),o=i.getMinutes();return a>n||a===n&&o>=r},y=()=>{console.log(`加载第`,n.value,`周课表`)},b=()=>{console.log(`选择日期:`,r.value)},x=(e,t,n,r=null)=>{for(let i=0;i<n;i++){let n=t+i;if(n>=l.length||c.value.some(t=>t.id!==r&&t.weekDay===e&&(t.timeSlot<=n&&t.timeSlot+t.duration>n||n<=t.timeSlot&&n+1>t.timeSlot)))return!0}return!1},S=()=>{o.courseName=``,o.classroom=``,o.studentCount=0,o.weekDay=0,o.timeSlot=0,o.duration=1,a.value=null};return ee(()=>{localStorage.getItem(`userToken`)||(localStorage.setItem(`userToken`,`mock-token-teacher-789`),localStorage.setItem(`userRole`,`teacher`)),r.value=new Date().toISOString().split(`T`)[0]}),{currentWeek:n,totalWeeks:20,selectedDate:r,timeSlots:l,weekDays:u,courses:c,courseForm:o,showAddCourseDialog:i,getCoursesForSlot:p,todayCourses:m,upcomingCourses:h,formatTodayDate:_,isCourseStarted:v,loadSchedule:y,onDateChange:b,exportSchedule:()=>{alert(`课表导出功能开发中...`)},viewCourseDetails:e=>{t.push(`/home/teacher/course-details?id=${e}`)},goToAttendance:e=>{t.push(`/home/teacher/attendance?courseId=${e}`)},goBack:()=>{t.push(`/home/teacher/dashboard`)},saveCourse:()=>{if(!o.courseName||!o.classroom||o.studentCount<=0){alert(`请填写完整的课程信息`);return}if(x(o.weekDay,o.timeSlot,o.duration,a.value)){alert(`所选时间段存在课程冲突，请重新选择`);return}let e=s[Math.floor(Math.random()*s.length)];if(a.value){let t=c.value.findIndex(e=>e.id===a.value);t!==-1&&(c.value[t]={...c.value[t],...o,color:e})}else{let t={id:Date.now(),...o,color:e};c.value.push(t)}i.value=!1,S(),alert(a.value?`课程更新成功`:`课程添加成功`)},resetCourseForm:S,openEditCourseDialog:e=>{o.courseName=e.courseName,o.classroom=e.classroom,o.studentCount=e.studentCount,o.weekDay=e.weekDay,o.timeSlot=e.timeSlot,o.duration=e.duration,a.value=e.id,i.value=!0},deleteCourse:e=>{confirm(`确定要删除这门课程吗？`)&&(c.value=c.value.filter(t=>t.id!==e),alert(`课程删除成功`))}}}},y={class:`teacher-course-schedule`},b={class:`page-header`},x={class:`schedule-container`},S={class:`filter-bar`},C={class:`filter-section`},w=[`value`],T={class:`filter-section`},E={class:`filter-actions`},D={class:`schedule-calendar`},O={class:`calendar-header`},k={class:`day-name`},A={class:`day-date`},j={class:`calendar-body`},M={class:`time-cell`},N={class:`time-range`},P={class:`course-name`},F={class:`course-info`},I={class:`course-actions`},L=[`onClick`],R=[`onClick`],z=[`onClick`],B=[`onClick`],V={class:`today-section`},H={class:`section-title`},U={class:`today-courses`},W={class:`course-time`},G={class:`course-main`},te={class:`course-title`},K={class:`course-detail`},q={class:`course-actions`},J=[`onClick`],Y={key:0,class:`empty-state`},X={class:`upcoming-section`},Z={class:`upcoming-courses`},Q={class:`course-date`},ne={class:`course-info`},re={class:`course-time`},ie={class:`course-name`},ae={class:`course-detail`},oe={class:`course-actions`},se=[`onClick`],ce={class:`dialog-header`},le={class:`dialog-body`},ue={class:`form-group`},de={class:`form-group`},fe={class:`form-group`},pe={class:`form-group`},$={class:`form-group`},me=[`value`],he={class:`form-group`},ge={class:`dialog-footer`};function _e(e,d,f,m,ee,v){return t(),a(`div`,y,[l(`div`,b,[l(`button`,{class:`back-button`,onClick:d[0]||=(...e)=>m.goBack&&m.goBack(...e)},`← 返回仪表盘`),d[18]||=l(`h2`,null,`课程安排管理`,-1)]),l(`div`,x,[l(`div`,S,[l(`div`,C,[d[19]||=l(`label`,null,`周次:`,-1),i(l(`select`,{"onUpdate:modelValue":d[1]||=e=>m.currentWeek=e,onChange:d[2]||=(...e)=>m.loadSchedule&&m.loadSchedule(...e)},[(t(!0),a(p,null,_(m.totalWeeks,e=>(t(),a(`option`,{key:e,value:e},`第`+r(e)+`周`,9,w))),128))],544),[[h,m.currentWeek]])]),l(`div`,T,[d[20]||=l(`label`,null,`日期:`,-1),i(l(`input`,{type:`date`,"onUpdate:modelValue":d[3]||=e=>m.selectedDate=e,onChange:d[4]||=(...e)=>m.onDateChange&&m.onDateChange(...e)},null,544),[[o,m.selectedDate]])]),l(`div`,E,[l(`button`,{class:`action-button export-button`,onClick:d[5]||=(...e)=>m.exportSchedule&&m.exportSchedule(...e)},`导出课表`),l(`button`,{class:`action-button primary`,onClick:d[6]||=e=>m.showAddCourseDialog=!0},`添加课程`)])]),l(`div`,D,[l(`div`,O,[d[21]||=l(`div`,{class:`time-column`},null,-1),(t(!0),a(p,null,_(m.weekDays,e=>(t(),a(`div`,{class:`day-column`,key:e.name},[l(`div`,k,r(e.name),1),l(`div`,A,r(e.date),1)]))),128))]),l(`div`,j,[(t(!0),a(p,null,_(m.timeSlots,(e,i)=>(t(),a(`div`,{key:i,class:`schedule-row`},[l(`div`,M,[l(`div`,N,r(e.time),1)]),(t(!0),a(p,null,_(m.weekDays,(e,o)=>(t(),a(`div`,{key:e.name,class:`schedule-cell`},[(t(!0),a(p,null,_(m.getCoursesForSlot(o,i),e=>(t(),a(`div`,{key:e.id,class:u([`course-item`,{"single-class":e.duration===1,"double-class":e.duration===2}]),style:n({backgroundColor:e.color,height:e.duration===2?`calc(200% - 4px)`:`100%`,top:(e.duration,`0`)})},[l(`div`,P,r(e.courseName),1),l(`div`,F,[l(`span`,null,r(e.classroom),1),l(`span`,null,r(e.studentCount)+`人`,1)]),l(`div`,I,[l(`button`,{class:`mini-button`,onClick:s(t=>m.viewCourseDetails(e.id),[`stop`])},`详情`,8,L),l(`button`,{class:`mini-button`,onClick:s(t=>m.goToAttendance(e.id),[`stop`])},`签到`,8,R),l(`button`,{class:`mini-button`,onClick:s(t=>m.openEditCourseDialog(e),[`stop`])},`编辑`,8,z),l(`button`,{class:`mini-button`,onClick:s(t=>m.deleteCourse(e.id),[`stop`])},`删除`,8,B)])],6))),128))]))),128))]))),128))])]),l(`div`,V,[l(`h3`,H,`今日课程 (`+r(m.formatTodayDate())+`)`,1),l(`div`,U,[(t(!0),a(p,null,_(m.todayCourses,e=>(t(),a(`div`,{key:e.id,class:`today-course-item`},[l(`div`,W,r(e.time),1),l(`div`,G,[l(`div`,te,r(e.courseName),1),l(`div`,K,`教室: `+r(e.classroom)+` | 学生: `+r(e.studentCount)+`人`,1)]),l(`div`,q,[l(`button`,{class:`action-button small primary`,onClick:t=>m.goToAttendance(e.id)},r(m.isCourseStarted(e.time)?`开始签到`:`课程未开始`),9,J)])]))),128)),m.todayCourses.length===0?(t(),a(`div`,Y,[...d[22]||=[l(`p`,null,`今日暂无课程安排`,-1)]])):c(``,!0)])]),l(`div`,X,[d[23]||=l(`h3`,{class:`section-title`},`即将到来的课程`,-1),l(`div`,Z,[(t(!0),a(p,null,_(m.upcomingCourses,e=>(t(),a(`div`,{key:e.id,class:`upcoming-course-item`},[l(`div`,Q,r(e.date),1),l(`div`,ne,[l(`div`,re,r(e.time),1),l(`div`,ie,r(e.courseName),1),l(`div`,ae,`教室: `+r(e.classroom),1)]),l(`div`,oe,[l(`button`,{class:`action-button small`,onClick:t=>m.viewCourseDetails(e.id)},`详情`,8,se)])]))),128))])])]),m.showAddCourseDialog?(t(),a(`div`,{key:0,class:`dialog-overlay`,onClick:d[17]||=e=>m.showAddCourseDialog=!1},[l(`div`,{class:`dialog-content`,onClick:d[16]||=s(()=>{},[`stop`])},[l(`div`,ce,[l(`h3`,null,r(e.editCourseId?`编辑课程`:`添加课程`),1),l(`button`,{class:`close-button`,onClick:d[7]||=e=>m.showAddCourseDialog=!1},`×`)]),l(`div`,le,[l(`div`,ue,[d[24]||=l(`label`,null,`课程名称:`,-1),i(l(`input`,{type:`text`,"onUpdate:modelValue":d[8]||=e=>m.courseForm.courseName=e,placeholder:`请输入课程名称`},null,512),[[o,m.courseForm.courseName]])]),l(`div`,de,[d[25]||=l(`label`,null,`教室:`,-1),i(l(`input`,{type:`text`,"onUpdate:modelValue":d[9]||=e=>m.courseForm.classroom=e,placeholder:`请输入教室`},null,512),[[o,m.courseForm.classroom]])]),l(`div`,fe,[d[26]||=l(`label`,null,`学生人数:`,-1),i(l(`input`,{type:`number`,"onUpdate:modelValue":d[10]||=e=>m.courseForm.studentCount=e,min:`1`,placeholder:`请输入学生人数`},null,512),[[o,m.courseForm.studentCount,void 0,{number:!0}]])]),l(`div`,pe,[d[28]||=l(`label`,null,`星期:`,-1),i(l(`select`,{"onUpdate:modelValue":d[11]||=e=>m.courseForm.weekDay=e},[...d[27]||=[g(`<option value="0" data-v-5e968821>周一</option><option value="1" data-v-5e968821>周二</option><option value="2" data-v-5e968821>周三</option><option value="3" data-v-5e968821>周四</option><option value="4" data-v-5e968821>周五</option>`,5)]],512),[[h,m.courseForm.weekDay]])]),l(`div`,$,[d[29]||=l(`label`,null,`时间段:`,-1),i(l(`select`,{"onUpdate:modelValue":d[12]||=e=>m.courseForm.timeSlot=e},[(t(!0),a(p,null,_(m.timeSlots,(e,n)=>(t(),a(`option`,{key:n,value:n},r(e.time),9,me))),128))],512),[[h,m.courseForm.timeSlot]])]),l(`div`,he,[d[31]||=l(`label`,null,`课程时长:`,-1),i(l(`select`,{"onUpdate:modelValue":d[13]||=e=>m.courseForm.duration=e},[...d[30]||=[l(`option`,{value:`1`},`1节 (90分钟)`,-1),l(`option`,{value:`2`},`2节 (180分钟)`,-1)]],512),[[h,m.courseForm.duration]])])]),l(`div`,ge,[l(`button`,{class:`action-button`,onClick:d[14]||=e=>m.showAddCourseDialog=!1},`取消`),l(`button`,{class:`action-button primary`,onClick:d[15]||=(...e)=>m.saveCourse&&m.saveCourse(...e)},r(e.editCourseId?`更新`:`保存`),1)])])])):c(``,!0)])}var ve=m(v,[[`render`,_e],[`__scopeId`,`data-v-5e968821`]]);export{ve as default};