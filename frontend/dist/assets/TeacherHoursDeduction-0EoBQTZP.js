import{A as e,C as t,N as n,O as r,_ as i,c as a,d as o,f as s,g as c,h as l,j as u,m as d,o as f,p,s as m,u as h,v as g,w as _,x as ee,y as v}from"./index-D-ACJEW6.js";var y={name:`TeacherHoursDeduction`,setup(){let t=f(),n=e(``),r=e(``),i=e(``),a=e(!1),o=e(!1),s=e(null),c=e(1),l=e(``),u=e(``),p=e(``),m=e(``),h=e(1),g=e(``),_=e([]),v=e([{id:1,name:`æ•°æ®ç»“æ„`},{id:2,name:`ç®—æ³•åˆ†æ`},{id:3,name:`æ•°æ®åº“åŸç†`},{id:4,name:`æ“ä½œç³»ç»Ÿ`},{id:5,name:`è®¡ç®—æœºç½‘ç»œ`}]),y=e([{id:1,name:`å¼ ä¸‰`,studentId:`20210001`,courseId:1,courseName:`æ•°æ®ç»“æ„`,remainingHours:32,status:`active`},{id:2,name:`æå››`,studentId:`20210002`,courseId:2,courseName:`ç®—æ³•åˆ†æ`,remainingHours:28,status:`active`},{id:3,name:`ç‹äº”`,studentId:`20210003`,courseId:1,courseName:`æ•°æ®ç»“æ„`,remainingHours:15,status:`active`},{id:4,name:`èµµå…­`,studentId:`20210004`,courseId:3,courseName:`æ•°æ®åº“åŸç†`,remainingHours:40,status:`active`},{id:5,name:`é’±ä¸ƒ`,studentId:`20210005`,courseId:2,courseName:`ç®—æ³•åˆ†æ`,remainingHours:5,status:`active`},{id:6,name:`å­™å…«`,studentId:`20210006`,courseId:4,courseName:`æ“ä½œç³»ç»Ÿ`,remainingHours:25,status:`paused`},{id:7,name:`å‘¨ä¹`,studentId:`20210007`,courseId:5,courseName:`è®¡ç®—æœºç½‘ç»œ`,remainingHours:0,status:`expired`},{id:8,name:`å´å`,studentId:`20210008`,courseId:3,courseName:`æ•°æ®åº“åŸç†`,remainingHours:30,status:`active`}]),b=d(()=>y.value.filter(e=>{let t=e.name.toLowerCase().includes(n.value.toLowerCase())||e.studentId.includes(n.value),a=!r.value||e.courseId===parseInt(r.value),o=!i.value||e.status===i.value;return t&&a&&o})),x=e=>e<=5?`hours-low`:e<=15?`hours-medium`:`hours-normal`,S=()=>{p.value=``},C=()=>{},w=e=>{s.value=e,c.value=1,l.value=``,u.value=``,p.value=``,a.value=!0},T=()=>{a.value=!1,s.value=null,p.value=``},E=()=>{if(!c.value||c.value<=0){p.value=`è¯·è¾“å…¥æœ‰æ•ˆçš„æ‰£é™¤è¯¾æ—¶æ•°`;return}if(!s.value){p.value=`æœªé€‰æ‹©å­¦ç”Ÿ`;return}if(c.value>s.value.remainingHours){p.value=`æ‰£é™¤è¯¾æ—¶æ•°ä¸èƒ½å¤§äºå‰©ä½™è¯¾æ—¶æ•°`;return}if(!l.value){p.value=`è¯·é€‰æ‹©æ‰£é™¤åŸå› `;return}let e=y.value.findIndex(e=>e.id===s.value.id);e!==-1&&(y.value[e].remainingHours-=c.value,y.value[e].remainingHours<=0&&(y.value[e].status=`expired`)),alert(`æˆåŠŸæ‰£é™¤ ${c.value} è¯¾æ—¶`),T()},D=d(()=>c.value>0&&s.value&&c.value<=s.value.remainingHours&&!!l.value),O=e=>{t.push(`/home/teacher/students?id=${e}`)},k=()=>{_.value=[]},A=d(()=>m.value?y.value.filter(e=>e.courseId===parseInt(m.value)&&e.status===`active`):[]),j=()=>{_.value=A.value.map(e=>e.id)},M=()=>{_.value=[]},N=()=>{m.value=``,h.value=1,g.value=``,_.value=[],o.value=!0},P=()=>{o.value=!1},F=()=>{if(!m.value||!h.value||h.value<=0||!g.value||_.value.length===0){alert(`è¯·å¡«å†™å®Œæ•´ä¿¡æ¯å¹¶é€‰æ‹©å­¦ç”Ÿ`);return}if(_.value.filter(e=>{let t=y.value.find(t=>t.id===e);return!t||t.remainingHours<h.value}).length>0){alert(`éƒ¨åˆ†å­¦ç”Ÿå‰©ä½™è¯¾æ—¶ä¸è¶³ï¼Œæ— æ³•å®Œæˆæ‰¹é‡æ‰£é™¤`);return}_.value.forEach(e=>{let t=y.value.findIndex(t=>t.id===e);t!==-1&&(y.value[t].remainingHours-=h.value,y.value[t].remainingHours<=0&&(y.value[t].status=`expired`))}),alert(`æˆåŠŸæ‰¹é‡æ‰£é™¤ ${_.value.length} åå­¦ç”Ÿçš„è¯¾æ—¶ï¼Œæ¯äºº ${h.value} è¯¾æ—¶`),P()},I=d(()=>m.value&&h.value>0&&g.value&&_.value.length>0);return ee(()=>{localStorage.getItem(`userToken`)||(localStorage.setItem(`userToken`,`mock-token-teacher-789`),localStorage.setItem(`userRole`,`teacher`))}),{searchQuery:n,selectedCourse:r,selectedStatus:i,filteredStudents:b,getHoursStatusClass:x,handleSearch:S,filterStudents:C,showDeductionModal:a,selectedStudent:s,deductionHours:c,deductionReason:l,deductionRemark:u,deductionError:p,canConfirmDeduction:D,openDeductionModal:w,closeDeductionModal:T,confirmDeduction:E,viewStudentDetails:O,showBatchModal:o,batchCourseId:m,batchDeductionHours:h,batchDeductionReason:g,selectedStudentsIds:_,courseStudents:A,canConfirmBatchDeduction:I,openBatchModal:N,closeBatchModal:P,confirmBatchDeduction:F,selectAllStudents:j,deselectAllStudents:M,loadCourseStudents:k,importAttendance:()=>{alert(`å¯¼å…¥å‡ºå‹¤è®°å½•åŠŸèƒ½å¼€å‘ä¸­...`)},courses:v,goBack:()=>{t.push(`/home/teacher/dashboard`)}}}},b={class:`teacher-hours-deduction`},x={class:`page-header`},S={class:`deduction-container`},C={class:`search-filter`},w={class:`search-section`},T={class:`search-input`},E={class:`filter-section`},D=[`value`],O={class:`students-list`},k={class:`list-content`},A={class:`student-info`},j={class:`student-name`},M={class:`student-id`},N={class:`student-course`},P={class:`student-hours`},F={class:`student-actions`},I=[`onClick`],L=[`onClick`],R={key:0,class:`empty-state`},z={class:`batch-section`},B={class:`batch-actions`},V={class:`modal-header`},H={class:`modal-body`},U={class:`deduction-form`},W={class:`form-group`},G={class:`info-display`},K={class:`form-group`},q={class:`info-display`},J={class:`form-group`},Y={class:`info-display`},X={class:`form-group`},Z=[`max`],te={key:0,class:`error-message`},Q={class:`form-group`},ne={class:`form-group`},re={class:`modal-footer`},ie=[`disabled`],ae={class:`modal-header`},oe={class:`modal-body`},se={class:`batch-form`},ce={class:`form-group`},le=[`value`],ue={class:`form-group`},de={class:`form-group`},fe={class:`form-group`},pe={class:`students-selection`},$=[`id`,`value`],me=[`for`],he={class:`student-name`},ge={class:`student-hours`},_e={class:`selection-actions`},ve={class:`modal-footer`},ye=[`disabled`];function be(e,d,f,m,ee,y){return t(),i(`div`,b,[l(`div`,x,[l(`button`,{class:`back-button`,onClick:d[0]||=(...e)=>m.goBack&&m.goBack(...e)},`â† è¿”å›ä»ªè¡¨ç›˜`),d[29]||=l(`h2`,null,`è¯¾æ—¶æ‰£é™¤æ“ä½œ`,-1)]),l(`div`,S,[l(`div`,C,[l(`div`,w,[l(`div`,T,[r(l(`input`,{type:`text`,"onUpdate:modelValue":d[1]||=e=>m.searchQuery=e,onInput:d[2]||=(...e)=>m.handleSearch&&m.handleSearch(...e),placeholder:`æœç´¢å­¦ç”Ÿå§“åæˆ–å­¦å·`},null,544),[[o,m.searchQuery]]),d[30]||=l(`span`,{class:`search-icon`},`ğŸ”`,-1)])]),l(`div`,E,[r(l(`select`,{"onUpdate:modelValue":d[3]||=e=>m.selectedCourse=e,onChange:d[4]||=(...e)=>m.filterStudents&&m.filterStudents(...e)},[d[31]||=l(`option`,{value:``},`æ‰€æœ‰è¯¾ç¨‹`,-1),(t(!0),i(p,null,_(m.courses,e=>(t(),i(`option`,{key:e.id,value:e.id},n(e.name),9,D))),128))],544),[[h,m.selectedCourse]]),r(l(`select`,{"onUpdate:modelValue":d[5]||=e=>m.selectedStatus=e,onChange:d[6]||=(...e)=>m.filterStudents&&m.filterStudents(...e)},[...d[32]||=[l(`option`,{value:``},`æ‰€æœ‰çŠ¶æ€`,-1),l(`option`,{value:`active`},`æ­£å¸¸`,-1),l(`option`,{value:`paused`},`å·²æš‚åœ`,-1),l(`option`,{value:`expired`},`å·²è¿‡æœŸ`,-1)]],544),[[h,m.selectedStatus]])])]),l(`div`,O,[d[34]||=g(`<div class="list-header" data-v-b64a6f18><div class="header-item" data-v-b64a6f18>å­¦ç”Ÿä¿¡æ¯</div><div class="header-item" data-v-b64a6f18>è¯¾ç¨‹</div><div class="header-item" data-v-b64a6f18>å‰©ä½™è¯¾æ—¶</div><div class="header-item" data-v-b64a6f18>æ“ä½œ</div></div>`,1),l(`div`,k,[(t(!0),i(p,null,_(m.filteredStudents,e=>(t(),i(`div`,{key:e.id,class:`student-item`},[l(`div`,A,[l(`div`,j,n(e.name),1),l(`div`,M,`å­¦å·: `+n(e.studentId),1)]),l(`div`,N,n(e.courseName),1),l(`div`,P,[l(`div`,{class:u([`hours-display`,m.getHoursStatusClass(e.remainingHours)])},n(e.remainingHours)+` è¯¾æ—¶ `,3)]),l(`div`,F,[l(`button`,{class:`action-button small primary`,onClick:t=>m.openDeductionModal(e)},` æ‰£é™¤è¯¾æ—¶ `,8,I),l(`button`,{class:`action-button small`,onClick:t=>m.viewStudentDetails(e.id)},` æŸ¥çœ‹è¯¦æƒ… `,8,L)])]))),128))]),m.filteredStudents.length===0?(t(),i(`div`,R,[...d[33]||=[l(`p`,null,`æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å­¦ç”Ÿ`,-1)]])):c(``,!0)]),l(`div`,z,[d[35]||=l(`h3`,{class:`section-title`},`æ‰¹é‡æ‰£é™¤è¯¾æ—¶`,-1),l(`div`,B,[l(`button`,{class:`action-button primary`,onClick:d[7]||=(...e)=>m.openBatchModal&&m.openBatchModal(...e)},`æ‰¹é‡æ‰£é™¤`),l(`button`,{class:`action-button`,onClick:d[8]||=(...e)=>m.importAttendance&&m.importAttendance(...e)},`å¯¼å…¥å‡ºå‹¤è®°å½•`)])])]),m.showDeductionModal?(t(),i(`div`,{key:0,class:`modal-overlay`,onClick:d[16]||=(...e)=>m.closeDeductionModal&&m.closeDeductionModal(...e)},[l(`div`,{class:`modal-content`,onClick:d[15]||=s(()=>{},[`stop`])},[l(`div`,V,[l(`h3`,null,`æ‰£é™¤è¯¾æ—¶ - `+n(m.selectedStudent?.name),1),l(`button`,{class:`close-button`,onClick:d[9]||=(...e)=>m.closeDeductionModal&&m.closeDeductionModal(...e)},`Ã—`)]),l(`div`,H,[l(`div`,U,[l(`div`,W,[d[36]||=l(`label`,null,`å­¦ç”Ÿä¿¡æ¯`,-1),l(`div`,G,[l(`span`,null,n(m.selectedStudent?.name),1),l(`span`,null,`(`+n(m.selectedStudent?.studentId)+`)`,1)])]),l(`div`,K,[d[37]||=l(`label`,null,`è¯¾ç¨‹åç§°`,-1),l(`div`,q,n(m.selectedStudent?.courseName),1)]),l(`div`,J,[d[38]||=l(`label`,null,`å½“å‰å‰©ä½™è¯¾æ—¶`,-1),l(`div`,Y,n(m.selectedStudent?.remainingHours)+` è¯¾æ—¶`,1)]),l(`div`,X,[d[39]||=l(`label`,null,[v(`æ‰£é™¤è¯¾æ—¶æ•° `),l(`span`,{class:`required`},`*`)],-1),r(l(`input`,{type:`number`,"onUpdate:modelValue":d[10]||=e=>m.deductionHours=e,min:`1`,max:m.selectedStudent?.remainingHours,placeholder:`è¯·è¾“å…¥æ‰£é™¤è¯¾æ—¶æ•°`},null,8,Z),[[o,m.deductionHours,void 0,{number:!0}]]),m.deductionError?(t(),i(`div`,te,n(m.deductionError),1)):c(``,!0)]),l(`div`,Q,[d[41]||=l(`label`,null,[v(`æ‰£é™¤åŸå›  `),l(`span`,{class:`required`},`*`)],-1),r(l(`select`,{"onUpdate:modelValue":d[11]||=e=>m.deductionReason=e},[...d[40]||=[g(`<option value="" data-v-b64a6f18>è¯·é€‰æ‹©æ‰£é™¤åŸå› </option><option value="normal_class" data-v-b64a6f18>æ­£å¸¸ä¸Šè¯¾</option><option value="makeup_class" data-v-b64a6f18>è¡¥è¯¾</option><option value="special_training" data-v-b64a6f18>ç‰¹è®­è¯¾ç¨‹</option><option value="other" data-v-b64a6f18>å…¶ä»–åŸå› </option>`,5)]],512),[[h,m.deductionReason]])]),l(`div`,ne,[d[42]||=l(`label`,null,`å¤‡æ³¨`,-1),r(l(`textarea`,{"onUpdate:modelValue":d[12]||=e=>m.deductionRemark=e,placeholder:`è¯·è¾“å…¥å¤‡æ³¨ä¿¡æ¯ï¼ˆé€‰å¡«ï¼‰`},null,512),[[o,m.deductionRemark]])])])]),l(`div`,re,[l(`button`,{class:`action-button`,onClick:d[13]||=(...e)=>m.closeDeductionModal&&m.closeDeductionModal(...e)},`å–æ¶ˆ`),l(`button`,{class:`action-button primary`,onClick:d[14]||=(...e)=>m.confirmDeduction&&m.confirmDeduction(...e),disabled:!m.canConfirmDeduction},` ç¡®è®¤æ‰£é™¤ `,8,ie)])])])):c(``,!0),m.showBatchModal?(t(),i(`div`,{key:1,class:`modal-overlay`,onClick:d[28]||=(...e)=>m.closeBatchModal&&m.closeBatchModal(...e)},[l(`div`,{class:`modal-content batch-modal`,onClick:d[27]||=s(()=>{},[`stop`])},[l(`div`,ae,[d[43]||=l(`h3`,null,`æ‰¹é‡æ‰£é™¤è¯¾æ—¶`,-1),l(`button`,{class:`close-button`,onClick:d[17]||=(...e)=>m.closeBatchModal&&m.closeBatchModal(...e)},`Ã—`)]),l(`div`,oe,[l(`div`,se,[l(`div`,ce,[d[45]||=l(`label`,null,[v(`é€‰æ‹©è¯¾ç¨‹ `),l(`span`,{class:`required`},`*`)],-1),r(l(`select`,{"onUpdate:modelValue":d[18]||=e=>m.batchCourseId=e,onChange:d[19]||=(...e)=>m.loadCourseStudents&&m.loadCourseStudents(...e)},[d[44]||=l(`option`,{value:``},`è¯·é€‰æ‹©è¯¾ç¨‹`,-1),(t(!0),i(p,null,_(m.courses,e=>(t(),i(`option`,{key:e.id,value:e.id},n(e.name),9,le))),128))],544),[[h,m.batchCourseId]])]),l(`div`,ue,[d[46]||=l(`label`,null,[v(`æ‰£é™¤è¯¾æ—¶æ•° `),l(`span`,{class:`required`},`*`)],-1),r(l(`input`,{type:`number`,"onUpdate:modelValue":d[20]||=e=>m.batchDeductionHours=e,min:`1`,placeholder:`è¯·è¾“å…¥æ‰£é™¤è¯¾æ—¶æ•°`},null,512),[[o,m.batchDeductionHours,void 0,{number:!0}]])]),l(`div`,de,[d[48]||=l(`label`,null,[v(`æ‰£é™¤åŸå›  `),l(`span`,{class:`required`},`*`)],-1),r(l(`select`,{"onUpdate:modelValue":d[21]||=e=>m.batchDeductionReason=e},[...d[47]||=[l(`option`,{value:``},`è¯·é€‰æ‹©æ‰£é™¤åŸå› `,-1),l(`option`,{value:`normal_class`},`æ­£å¸¸ä¸Šè¯¾`,-1),l(`option`,{value:`makeup_class`},`è¡¥è¯¾`,-1),l(`option`,{value:`special_training`},`ç‰¹è®­è¯¾ç¨‹`,-1)]],512),[[h,m.batchDeductionReason]])]),l(`div`,fe,[d[49]||=l(`label`,null,`é€‰æ‹©å­¦ç”Ÿ`,-1),l(`div`,pe,[(t(!0),i(p,null,_(m.courseStudents,e=>(t(),i(`div`,{key:e.id,class:`student-checkbox`},[r(l(`input`,{type:`checkbox`,id:`student-${e.id}`,value:e.id,"onUpdate:modelValue":d[22]||=e=>m.selectedStudentsIds=e},null,8,$),[[a,m.selectedStudentsIds]]),l(`label`,{for:`student-${e.id}`},[l(`span`,he,n(e.name),1),l(`span`,ge,`(å‰©ä½™: `+n(e.remainingHours)+`è¯¾æ—¶)`,1)],8,me)]))),128))]),l(`div`,_e,[l(`button`,{class:`small-button`,onClick:d[23]||=(...e)=>m.selectAllStudents&&m.selectAllStudents(...e)},`å…¨é€‰`),l(`button`,{class:`small-button`,onClick:d[24]||=(...e)=>m.deselectAllStudents&&m.deselectAllStudents(...e)},`å–æ¶ˆå…¨é€‰`)])])])]),l(`div`,ve,[l(`button`,{class:`action-button`,onClick:d[25]||=(...e)=>m.closeBatchModal&&m.closeBatchModal(...e)},`å–æ¶ˆ`),l(`button`,{class:`action-button primary`,onClick:d[26]||=(...e)=>m.confirmBatchDeduction&&m.confirmBatchDeduction(...e),disabled:!m.canConfirmBatchDeduction},` ç¡®è®¤æ‰¹é‡æ‰£é™¤ `,8,ye)])])])):c(``,!0)])}var xe=m(y,[[`render`,be],[`__scopeId`,`data-v-b64a6f18`]]);export{xe as default};