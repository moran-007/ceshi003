import{A as e,C as t,D as n,N as r,S as i,T as a,_ as o,b as s,g as c,h as l,i as u,j as d,m as f,p,s as m,t as h,w as g,x as _}from"./index-D-ACJEW6.js";var v=null,y=async()=>{if(!v)try{let e=await h(()=>import(`./auto-bi60b1u0.js`),[]);v=e.default||e}catch(e){console.error(`Failed to load Chart.js:`,e)}return v},b={name:`GradeAnalysis`,setup(){let t=e(null),n=e(null),r=null,a=null,o=f(()=>u.mockData&&u.mockData.scores&&u.mockData.scores.length>0?u.mockData.scores:[{score_id:1,course_id:1,course_name:`数据结构`,exam_type:`midterm`,exam_type_text:`期中考试`,score_value:85,exam_date:`2023-10-15`,remarks:`表现良好`},{score_id:2,course_id:1,course_name:`数据结构`,exam_type:`quiz`,exam_type_text:`课堂测验`,score_value:92,exam_date:`2023-09-25`,remarks:`优秀！`},{score_id:3,course_id:2,course_name:`操作系统`,exam_type:`midterm`,exam_type_text:`期中考试`,score_value:78,exam_date:`2023-10-10`,remarks:`需要加强练习`},{score_id:4,course_id:3,course_name:`计算机网络`,exam_type:`assignment`,exam_type_text:`课后作业`,score_value:88,exam_date:`2023-09-30`,remarks:`作业完成质量较高`},{score_id:5,course_id:4,course_name:`数据库原理`,exam_type:`midterm`,exam_type_text:`期中考试`,score_value:65,exam_date:`2023-10-12`,remarks:`及格，需要加强理解概念`},{score_id:6,course_id:1,course_name:`数据结构`,exam_type:`assignment`,exam_type_text:`课后作业`,score_value:88,exam_date:`2023-09-20`,remarks:`完成度高`},{score_id:7,course_id:2,course_name:`操作系统`,exam_type:`quiz`,exam_type_text:`课堂测验`,score_value:75,exam_date:`2023-09-18`,remarks:`基础概念需加强`},{score_id:8,course_id:3,course_name:`计算机网络`,exam_type:`quiz`,exam_type_text:`课堂测验`,score_value:90,exam_date:`2023-09-15`,remarks:`优秀！`}]),s=f(()=>{let e=o.value;if(e.length===0)return{average:0,highest:0,lowest:0,passRate:0};let t=e.map(e=>e.score_value),n=Math.round(t.reduce((e,t)=>e+t,0)/t.length),r=Math.max(...t),i=Math.min(...t),a=t.filter(e=>e>=60).length,s=Math.round(a/t.length*100);return{average:n,highest:r,lowest:i,passRate:s}}),c=f(()=>{let e=o.value;if(e.length===0)return null;let t={};e.forEach(e=>{t[e.course_name]||(t[e.course_name]=[]),t[e.course_name].push(e.score_value)});let n=Object.keys(t),r=n.map(e=>{let n=t[e];return Math.round(n.reduce((e,t)=>e+t,0)/n.length)});return{labels:n,data:r}}),l=f(()=>{let e=[...o.value];if(e.length===0)return[];e.sort((e,t)=>new Date(e.exam_date)-new Date(t.exam_date));let t={};return e.forEach(e=>{t[e.exam_date]||(t[e.exam_date]=[]),t[e.exam_date].push(e.score_value)}),Object.entries(t).map(([e,t])=>({date:e,average:Math.round(t.reduce((e,t)=>e+t,0)/t.length)}))}),d=f(()=>{let e=o.value;return e.length===0?[]:e.filter(e=>e.score_value<70).sort((e,t)=>e.score_value-t.score_value)}),p=e=>e>=90?`grade-excellent`:e>=80?`grade-good`:e>=60?`grade-pass`:`grade-fail`,m=e=>e>=90?`优秀`:e>=80?`良好`:e>=70?`中等`:e>=60?`及格`:`不及格`,h=e=>e.score_value<60?`${e.course_name}课程的成绩未达到及格线，需要重点关注该科目的学习。`:`${e.course_name}课程的成绩处于及格边缘，有较大的提升空间。`,g=e=>{let t=[`建议与任课老师沟通，找出具体的薄弱环节`,`增加该科目的学习时间，重点复习基础知识`,`参加相关的辅导课程或学习小组`,`多做练习题，巩固知识点`,`制定详细的学习计划，循序渐进地提升`],n=[];for(;n.length<2;){let e=Math.floor(Math.random()*t.length);n.includes(t[e])||n.push(t[e])}return n},b=async()=>{if(!c.value||!t.value||(await y(),!v))return;r&&r.destroy();let e=t.value.getContext(`2d`);r=new v(e,{type:`radar`,data:{labels:c.value.labels,datasets:[{label:`平均成绩`,data:c.value.data,backgroundColor:`rgba(102, 126, 234, 0.2)`,borderColor:`rgba(102, 126, 234, 1)`,borderWidth:2,pointBackgroundColor:`rgba(102, 126, 234, 1)`,pointBorderColor:`#fff`,pointHoverBackgroundColor:`#fff`,pointHoverBorderColor:`rgba(102, 126, 234, 1)`}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{r:{min:0,max:100,ticks:{stepSize:20}}},plugins:{legend:{display:!0,position:`bottom`},tooltip:{callbacks:{label:function(e){return`成绩: ${e.parsed.r}`}}}}}})},x=async()=>{if(!l.value.length||!n.value||(await y(),!v))return;a&&a.destroy();let e=n.value.getContext(`2d`);a=new v(e,{type:`line`,data:{labels:l.value.map(e=>e.date),datasets:[{label:`平均成绩`,data:l.value.map(e=>e.average),fill:!0,backgroundColor:`rgba(102, 126, 234, 0.2)`,borderColor:`rgba(102, 126, 234, 1)`,borderWidth:2,tension:.4,pointBackgroundColor:`rgba(102, 126, 234, 1)`,pointBorderColor:`#fff`,pointRadius:4,pointHoverRadius:6}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{min:0,max:100,ticks:{stepSize:20},title:{display:!0,text:`成绩`}},x:{title:{display:!0,text:`日期`}}},plugins:{legend:{display:!0,position:`bottom`},tooltip:{callbacks:{label:function(e){return`平均成绩: ${e.parsed.y}`}}}}}})},S=()=>{b(),x()};return _(()=>{setTimeout(()=>{b(),x()},100),window.addEventListener(`resize`,S)}),i(()=>{window.removeEventListener(`resize`,S),r&&r.destroy(),a&&a.destroy()}),{radarChart:t,trendChart:n,allGrades:o,overallStats:s,chartData:c,trendData:l,weakSubjects:d,getGradeClass:p,getGradeLevel:m,getWeakSubjectAnalysis:h,getImprovementTips:g}}},x={class:`grade-analysis`},S={class:`analysis-header`},C={class:`overview-card`},w={class:`stats-grid`},T={class:`stat-card`},E={class:`stat-value`},D={class:`stat-card`},O={class:`stat-value`},k={class:`stat-card`},A={class:`stat-value`},j={class:`stat-card`},M={class:`stat-value`},N={class:`radar-chart-card`},P={class:`chart-container`},F={key:0,class:`chart-placeholder`},I={key:1,ref:`radarChart`},L={class:`trend-chart-card`},R={class:`chart-container`},z={key:0,class:`chart-placeholder`},B={key:1,ref:`trendChart`},V={class:`grades-table-card`},H={class:`table-responsive`},U={class:`grades-table`},W={key:0,class:`empty-state`},G={class:`weak-subjects-card`},K={key:0,class:`subjects-list`},q={class:`subject-header`},J={class:`subject-score`},Y={class:`subject-analysis`},X={class:`improvement-tips`},Z={key:1,class:`no-weak-subjects`};function Q(e,i,u,f,m,h){let _=a(`router-link`);return t(),o(`div`,x,[l(`div`,S,[s(_,{to:`/home/student/dashboard`,class:`back-button`},{default:n(()=>[...i[0]||=[l(`span`,null,`← 返回仪表盘`,-1)]]),_:1}),i[1]||=l(`h2`,null,`成绩分析`,-1)]),l(`div`,C,[i[6]||=l(`h3`,null,`成绩概览`,-1),l(`div`,w,[l(`div`,T,[l(`div`,E,r(f.overallStats.average),1),i[2]||=l(`div`,{class:`stat-label`},`平均成绩`,-1)]),l(`div`,D,[l(`div`,O,r(f.overallStats.highest),1),i[3]||=l(`div`,{class:`stat-label`},`最高成绩`,-1)]),l(`div`,k,[l(`div`,A,r(f.overallStats.lowest),1),i[4]||=l(`div`,{class:`stat-label`},`最低成绩`,-1)]),l(`div`,j,[l(`div`,M,r(f.overallStats.passRate)+`%`,1),i[5]||=l(`div`,{class:`stat-label`},`及格率`,-1)])])]),l(`div`,N,[i[7]||=l(`h3`,null,`各科成绩对比`,-1),l(`div`,P,[f.chartData?(t(),o(`canvas`,I,null,512)):(t(),o(`div`,F,`暂无足够数据生成图表`))])]),l(`div`,L,[i[8]||=l(`h3`,null,`成绩趋势`,-1),l(`div`,R,[f.trendData.length?(t(),o(`canvas`,B,null,512)):(t(),o(`div`,z,`暂无足够数据生成图表`))])]),l(`div`,V,[i[11]||=l(`h3`,null,`详细成绩记录`,-1),l(`div`,H,[l(`table`,U,[i[9]||=l(`thead`,null,[l(`tr`,null,[l(`th`,null,`课程名称`),l(`th`,null,`考试类型`),l(`th`,null,`分数`),l(`th`,null,`等级`),l(`th`,null,`考试日期`),l(`th`,null,`教师评价`)])],-1),l(`tbody`,null,[(t(!0),o(p,null,g(f.allGrades,e=>(t(),o(`tr`,{key:`${e.course_id}-${e.exam_type}`},[l(`td`,null,r(e.course_name),1),l(`td`,null,r(e.exam_type_text),1),l(`td`,{class:d(f.getGradeClass(e.score_value))},r(e.score_value),3),l(`td`,null,r(f.getGradeLevel(e.score_value)),1),l(`td`,null,r(e.exam_date),1),l(`td`,null,r(e.remarks||`无`),1)]))),128))])]),f.allGrades.length===0?(t(),o(`div`,W,[...i[10]||=[l(`p`,null,`暂无成绩记录`,-1)]])):c(``,!0)])]),l(`div`,G,[i[14]||=l(`h3`,null,`薄弱科目分析`,-1),f.weakSubjects.length>0?(t(),o(`div`,K,[(t(!0),o(p,null,g(f.weakSubjects,e=>(t(),o(`div`,{key:e.course_id,class:`subject-card`},[l(`div`,q,[l(`h4`,null,r(e.course_name),1),l(`span`,J,r(e.score_value),1)]),l(`div`,Y,[l(`p`,null,r(f.getWeakSubjectAnalysis(e)),1)]),l(`div`,X,[i[12]||=l(`h5`,null,`改进建议：`,-1),l(`ul`,null,[l(`li`,null,r(f.getImprovementTips(e)[0]),1),l(`li`,null,r(f.getImprovementTips(e)[1]),1)])])]))),128))])):(t(),o(`div`,Z,[...i[13]||=[l(`p`,null,`所有科目表现良好，继续保持！`,-1)]]))])])}var $=m(b,[[`render`,Q],[`__scopeId`,`data-v-45218d35`]]);export{$ as default};